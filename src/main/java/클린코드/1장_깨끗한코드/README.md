## 코드가 존재하리라

- 궁극적으로 코드는 요구사항을 표현하는 언어다

---

## 나쁜 코드

- 프로그래머라면 누구나 나쁜 코드로 고생한 경험이 있다. 어째서 나쁜 코드를 짰는가? 급해서? 서두르느라? 코드 다듬다가 욕 먹을까봐? 지겨워서 빨리 끝내려고?
- 우리는 내가 짠 쓰레기 코드를 보며 나중에 손보겠다고 생각한 경험이 있다
- 르블랑의 법칙 : 나중은 결코 오지 않는다
> 나중이란 절대 오지 않으니 코드를 작성할 때 최선을 다해서 깨끗하게 짜야 한다

---

### 태도

- 일정에 쫓겨도 대다수 관리자는 좋은 코드를 원한다. 일정과 요구사항을 강하게 밀어붙이는 이유는 그게 그들의 책임이라서다
- 좋은 코드를 사수하는 일은 프로그래머의 책임이다. 나쁜 코드의 위험을 이해 못하는 관리자 말을 따르는 행동은 전문가답지 못하다

---

### 원초적 난제

- 누구나 나쁜 코드가 업무 속도를 늦춘다는 사실을 아다. 그럼에도 모든 프로그래머가 기한을 맞추려면 나쁜 코드를 양산할 수밖에 없다고 느낀다. 이들은 빨리 가려고 시간을 들이지 않는다
- 기한을 맞추는 유일한 방법은 언제나 코드를 최대한 깨끗하게 유지하는 습관이다

---

### 깨끗한 코드란?

> 비야네 스트롭스트룹(C++ 창시자) : 나는 우아하고 효율적인 코드를 좋아한다  
> 논리가 간단해야 버그가 숨어들지 못한다. 의존성을 최대한 줄여야 유지보수가 쉬워진다  
> 오류는 명백한 전략에 의거해 철저히 처리한다  
> 성능을 최적으로 유지해야 사람들이 원치 않는 최적화로 코드를 망치려는 유혹에 빠지지 않는다  
> 깨끗한 코드는 1가지를 제대로 한다

- 우아한 : 외양이나 태도가 기품 있고 단아하며 보기에 즐거운
- 비야네는 깨끗한 코드는 '보기에 즐거운' 코드라고 한다. 그리고 효율도 언급한다
- 나쁜 코드는 나쁜 코드를 유혹한다. 나쁜 코드를 고치며 더 나쁜 코드를 만든다
- 실용주의 프로그래머 데이브 토마스, 앤디 헌트 : 깨진 창문 비유로 같은 이야기를 표현함
- 창문이 깨진 건물은 누구도 신경쓰지 않는다. 그래서 사람들은 창문이 더 깨져도 상관하지 않고 자발적으로 창문을 깨고, 낙서를 방치하고 차고에 쓰레기가 쌓여도 치우지 않는다
- 창문이 깨지고 나면 쇠퇴하는 과정이 시작된다
- 비야네는 철저한 오류 처리도 언급한다. 세세한 것까지 꼼꼼하게 신경쓰란 말이다. 프로그래머들이 대충 넘어가는 부분 중 하나가 오류 처리다. 메모리 누수, 경쟁 상태, 일관성 없는 명명법이 또 다른 예다
- 즉 깨끗한 코드는 세세한 사항까지 꼼꼼하게 처리하는 코드다
- 마지막으로 비야네는 깨끗한 코드는 한 가지를 잘 한다고 단언한다. 수많은 SW 설계 원칙이 이 간단한 교훈 하나로 귀결된다
- 나쁜 코드는 너무 많은 일을 하려다가 의도가 뒤섞이고 목적이 흐려진다
- 깨끗한 코드는 한 가지에 집중한다. 각 함수, 클래스, 모듈은 주변에 현혹되거나 오염되지 않고 한 길만 걷는다

> 정리 : 깨끗한 코드는 다른 개발자가 보기에 즐겁고(좋고), 메모리 릭 등 예외 처리가 꼼꼼하며, 세세하게 한 가지만을 잘 하는 코드다

---

> 그래디 부치 : 깨끗한 코드는 단순하고 직접적이다. 깨끗한 코드는 잘 쓴 문장처럼 읽힌다   
> 깨끗한 코드는 결코 설계자의 의도를 숨기지 않는다. 오히려 명쾌한 추상화와 단순한 제어문으로 가득하다

- 비야네와 흡사하지만 가독성을 강조한다
- 읽은 책 중 진짜로 좋았던 책을 보면 단어가 사라지고 이미지가 떠오르는 것처럼, 깨끗한 코드는 해결할 문제의 긴장을 명확히 드러내야 한다
- 긴장을 쌓으며 클라이맥스에 이르렀다가 명백한 해법을 제시하며 긴장, 문제를 풀어야 한다
- 명쾌한 추상화 : 코드는 사실에 기반해야 한다. 반드시 필요한 내용만 담아야 한다. 코드를 읽는 사람에게 프로그래머가 단호하다는 인상을 줘야 한다
> 정리 : 깨끗한 코드는 필요한 내용만 가독성 좋게 보여줘 설계자의 의도를 잘 보여주는 코드다

---

> 데이브 토마스(OTI 창립자) : 깨끗한 코드는 작성자가 아닌 사람도 읽기 쉽고 고치기 쉽다  
> 단위 테스트 케이스와 인수 테스트 케이스가 존재한다  
> 깨끗한 코드에는 의미 있는 이름이 붙는다. 특정 목적을 달성하는 방법은 하나만 제공한다  
> 의존성은 최소이며 각 의존성을 명확히 정의한다. API는 명확하며 최소로 줄였다  
> 언어에 따라 필요한 모든 정보를 코드만으로 명확히 표현할 수 없기에, 코드는 문학적으로 표현해야 마땅하다

- 그래디와 마찬가지로 가독성을 강조하지만, 다른 사람이 고치기 쉬워야 깨끗한 코드라고 한다. 읽기 쉬운 코드와 고치기 쉬운 코드는 엄연히 다르다
- 테스트 주도 개발(TDD)이 근본적인 원칙 중 하나가 되면서 깨끗한 코드를 테스트 케이스와 연관짓는다. 아무리 코드가 우아하고 가독성이 좋아도 테스트 케이스가 없으면 깨끗하지 않다
- 최소라는 단어를 2번 사용했다. 큰 코드보다 작은 코드에 가치를 둔다는 의미다. 이건 개발 분야가 탄생한 이래로 SW 문헌에서 계속 반복하는 교훈이기도 하다. 작을수록 좋다
- 코드가 문학적이어야 한다 : 인간이 읽기 좋은 코드를 작성하라

> 정리 : 깨끗한 코드는 다른 개발자가 읽기 좋고 고치기 쉬우며, 작은 규모에 테스트 케이스가 있어야 한다

---

> 론 제프리스 : 간단한 코드는  
> - 모든 테스트를 통과한다  
> - 중복이 없다  
> - 시스템 내 모든 설계 아이디어를 표현한다  
> - 클래스, 메서드, 함수 등을 최대한 줄인다
> 
> 나는 중복에 집중한다. 같은 작업을 여러 번 반복한다면 코드가 아이디어를 제대로 표현 못 한다는 증거다  
> 나는 문제와 아이디어를 좀 더 명확하게 표현하려 애쓴다. 내게 있어 표현력은 의미 있는 이름을 포함한다  
> 보통 나는 확정하기 전에 이름을 여러 차례 바꾼다. 이클립스 같은 최신 개발 도구는 이름 바꾸기가 상당히 쉽다  
> 그래서 별 고충 없이 이름을 바꾼다. 하지만 표현력은 이름에만 국한되지 않는다  
> 나는 여러 기능을 수행하는 객체, 메서드도 찾는다. 객체가 여러 기능을 수행한다면 여러 객체로 나눈다  
> 메서드가 여러 기능을 수행한다면 메서드 추출 리팩토링 기법을 적용해, 기능을 명확히 기술하는 메서드 하나와
> 기능을 실제로 수행하는 메서드 여러 개로 나눈다  
> 중복과 표현력만 신경 써도 (내가 생각하는) 깨끗한 코드란 목표에 성큼 다가선다. 하지만 나는 한 가지를 더 고려한다  
> 나는 모든 프로그램이 유사한 요소로 이뤄진다는 사실을 깨달았다. 한 가지 예가 '집합에서 항목 찾기'다  
> 어떤 집합에서 특정 항목을 찾아낼 필요가 자주 생긴다. 이런 상황이 발생하면 추상 메서드나 추상 클래스를 만들어 실제 구현을 감싼다  
> 그러면 여러 장점이 생긴다. 이제 실제 기능은 아주 간단한 방식으로(해시맵) 구현해도 괜찮다  
> 다른 코드는 추상 클래스나 추상 메서드가 제공하는 기능을 사용하므로 실제 구현은 언제든 바꿔도 괜찮다. 지금은 빨리 구현했다가 나중에 필요할 때 바꾸면 된다  
> 게다가 집합을 추상화하면 '진짜' 문제에 신경 쓸 여유가 생긴다. 간단한 찾기 기능이 필요한데 온갖 집합 기능을 구현하느라 시간, 노력을 낭비할 필요가 없어진다  
> 중복 줄이기, 표현력 높이기, 초반부터 간단한 추상화 고려하기. 내겐 이 3가지가 깨끗한 코드를 만드는 비결이다

- 중복을 피해라. 한 기능만 수행하라. 제대로 표현하라. 작게 추상화하라
- 위 4가지가 이 책의 내용을 요약한 것이다

---

> 워드 커닝햄(위키 창시자) : 코드를 읽으면서 짐작했던 기능을 각 루틴이 그대로 수행하면 깨끗한 코드라 불러도 되겠다  
> 코드가 그 문제를 풀기 위한 언어처럼 보인다면 아름다운 코드라 불러도 되겠다

- 깨끗한 코드는 읽으면서 놀랄 일이 없어야 한다. 읽으면서 짐작한 대로 돌아가는 코드가 깨끗한 코드다. 명백하고 단순해서 마음이 끌리는 코드가 깨끗한 코드다
- 코드가 그 문제를 풀기 위한 언어처럼 보인다면 : 언어를 단순하게 보이도록 만드는 책임은 개발자에게 있다

> 정리 : 깨끗한 코드는 읽고 예상한 대로 동작하며, 단순하게 보이는 코드다

---

- 다음에 코드를 짤 때는 내가 저자, 내 노력을 보고 판단할 독자가 있다는 걸 기억해라
- 새 코드를 짜면서 끊임없이 기존 코드를 읽는다. 그래서 읽기 쉬운 코드를 짜기가 쉽지 않지만 읽기 쉬운 코드가 매우 중요하다
- 하지만 기존 코드를 읽어야 새 코드를 짜므로 읽기 쉽게 만들면 짜기도 쉬워진다. 그래서 급하고 빨리 끝내려면, 쉽게 짜려면 읽기 쉽게 만들면 된다

---

### 보이스카우트 원칙

- 코드를 잘 짠다고 전부가 아니다. 시간이 지나도 항상 깨끗하게 유지해야 한다. 적극적으로 코드의 퇴보를 막아야 한다
- 미국 보이스카우트가 따르는 간단한 규칙이 개발 전문가에게도 유용하다

> 캠프장은 처음 왔을 때보다 더 깨끗하게 해놓고 떠나라

- 체크아웃할 때보다 더 깨끗한 코드를 체크인한다면 코드는 절대 나빠지지 않는다. 한꺼번에 많은 시간, 노력을 투자해 코드를 정리할 필요가 없다. 변수명 하나를 개선하고, 좀 긴 함수 하나를 분할하고, 약간의 중복 제거하고 복잡한 if문 하나를 정리하면 충분하다
- 지속적 개선은 전문가의 본질이다